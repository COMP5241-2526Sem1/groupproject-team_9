# 学生导入功能使用指南

## 功能概述

学生导入功能允许老师通过CSV或Excel文件批量导入学生到课程中。这个功能大大简化了课程管理，特别是对于大型班级。

## 支持的文件格式

- **CSV文件** (.csv)
- **Excel文件** (.xlsx, .xls)

## 文件格式要求

### 必需的列
- `name` - 学生姓名
- `email` - 学生邮箱地址

### 可选的列
- `studentId` - 学号
- `institution` - 学校/机构（默认为PolyU）

### 示例CSV格式
```csv
name,email,studentId,institution
John Doe,john.doe@example.com,123456,PolyU
Jane Smith,jane.smith@example.com,789012,PolyU
Alice Johnson,alice.johnson@example.com,345678,PolyU
```

## 使用步骤

1. **进入课程详情页面**
   - 登录系统
   - 导航到要添加学生的课程
   - 在课程统计卡片中找到"Import Students"按钮

2. **准备学生数据文件**
   - 下载CSV模板（点击"Download CSV Template"）
   - 按照模板格式填写学生信息
   - 确保邮箱地址格式正确

3. **上传文件**
   - 点击"Import Students"按钮
   - 在对话框中点击"Choose File"或拖拽文件到上传区域
   - 支持的文件大小限制：10MB

4. **执行导入**
   - 确认文件选择正确后，点击"Import Students"
   - 系统会显示导入进度

5. **查看结果**
   - 导入完成后会显示详细结果
   - 包括成功导入的学生数量和失败的原因
   - 可以查看具体的学生信息和错误信息

## 数据验证规则

### 邮箱验证
- 必须是有效的邮箱格式
- 系统会自动转换为小写
- 邮箱必须唯一

### 学号验证
- 如果提供学号，必须是唯一的
- 学号可以为空

### 姓名验证
- 姓名不能为空
- 会自动去除首尾空格

## 错误处理

系统会处理以下常见错误：

1. **重复学生**
   - 如果学生已存在于系统中，会直接添加到课程
   - 如果学生已在课程中，会跳过并显示提示

2. **格式错误**
   - 无效的邮箱格式
   - 缺少必需字段
   - 文件格式不支持

3. **权限错误**
   - 只有课程讲师可以导入学生
   - 需要适当的系统权限

## 导入结果说明

### 成功统计
- 显示成功导入的学生数量
- 列出所有成功添加的学生信息

### 失败统计
- 显示失败的学生数量
- 提供详细的错误信息
- 帮助用户修正数据后重新导入

## 最佳实践

1. **数据准备**
   - 使用提供的CSV模板
   - 确保邮箱地址准确无误
   - 检查学号是否重复

2. **分批导入**
   - 对于大量学生，建议分批导入
   - 每批不超过1000名学生

3. **验证结果**
   - 导入后检查学生列表
   - 确认所有学生都已正确添加

## 技术限制

- 文件大小限制：10MB
- 支持的文件类型：CSV, XLSX, XLS
- 最大学生数量：建议每批不超过1000名

## 故障排除

### 常见问题

1. **文件无法上传**
   - 检查文件格式是否支持
   - 确认文件大小不超过10MB
   - 检查网络连接

2. **导入失败**
   - 检查CSV格式是否正确
   - 确认必需字段已填写
   - 验证邮箱格式

3. **部分学生导入失败**
   - 查看错误信息
   - 修正数据后重新导入失败的学生

### 联系支持

如果遇到技术问题，请联系系统管理员或技术支持团队。
